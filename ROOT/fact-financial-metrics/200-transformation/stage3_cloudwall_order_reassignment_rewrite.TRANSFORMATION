{"job":{"components":{"2004301":{"id":2004301,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":384,"y":144,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004347],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_cloudwall_fact_financial_metrics + stg2_cloudwall_order_reassignment"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with\n cor as (\n    select *,count(*) over(partition by or__employee_person_id,or__approval_week_ending_sunday) as or__count_cor\n    from staging.stg2_cloudwall_order_reassignment\n)\n,stg as (\n    select *,count(*) over(partition by employee_person_id,approval_week_ending_sunday) as or__count_stg\n    from staging.stg1_cloudwall_fact_financial_metrics stg\n    where exists (select 1 from cor\n                  where stg.employee_person_id          = cor.or__employee_person_id\n                    and stg.approval_week_ending_sunday = cor.or__approval_week_ending_sunday\n                    and coalesce(stg.order_id,0)        = 0\n                 )\n)\n\nselect *\nfrom stg\ninner join cor on stg.employee_person_id          = cor.or__employee_person_id\n              and stg.approval_week_ending_sunday = cor.or__approval_week_ending_sunday\n              and coalesce(stg.order_id,0)        = 0\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004348":{"id":2004348,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":736,"y":144,"width":32,"height":32,"inputConnectorIDs":[2004346],"outputConnectorIDs":[2004344],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"numeric values spread"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"revenue_amount / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"revenue_amount"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"cost_amount / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"cost_amount"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"rebate_amount / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"rebate_amount"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"tax_amount / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"tax_amount"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"invoiced_discount_amount / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"invoiced_discount_amount"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"hour_adjustment / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"hour_adjustment"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_regular_hours / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"timecard_regular_hours"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_hours / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_hours"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_double_time_hours / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"timecard_double_time_hours"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_other_hours / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"timecard_other_hours"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_1_hours / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_1_hours"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_2_hours / (or__count_cor*1.0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_2_hours"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004349":{"id":2004349,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":928,"y":144,"width":32,"height":32,"inputConnectorIDs":[2004344],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg3_cloudwall_order_reassignment"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg3_cloudwall_order_reassignment"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004350":{"id":2004350,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":576,"y":144,"width":32,"height":32,"inputConnectorIDs":[2004347],"outputConnectorIDs":[2004346],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"order reassignment"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"or__order_id"},"2":{"slot":2,"type":"STRING","value":"order_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"or__order_sk"},"2":{"slot":2,"type":"STRING","value":"order_sk"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"or__client_sk"},"2":{"slot":2,"type":"STRING","value":"client_sk"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"or__client_id"},"2":{"slot":2,"type":"STRING","value":"client_id"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"or__market_sk"},"2":{"slot":2,"type":"STRING","value":"market_sk"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"or__market_id"},"2":{"slot":2,"type":"STRING","value":"market_id"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"or__currency_sk"},"2":{"slot":2,"type":"STRING","value":"currency_sk"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"or__currency_id"},"2":{"slot":2,"type":"STRING","value":"currency_id"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"or__exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"exchange_rate_id"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"2004344":{"id":2004344,"sourceID":2004348,"targetID":2004349},"2004346":{"id":2004346,"sourceID":2004350,"targetID":2004348},"2004347":{"id":2004347,"sourceID":2004301,"targetID":2004350}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"stage3_cloudwall_order_reassignment_rewrite","description":"","type":"TRANSFORMATION","tag":"f48710a4-a493-4c4e-94da-a5f0d38d321d"}}