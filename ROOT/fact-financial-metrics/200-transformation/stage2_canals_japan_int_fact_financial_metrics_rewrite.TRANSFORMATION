{"job":{"components":{"2004958":{"id":2004958,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1008,"y":304,"width":32,"height":32,"inputConnectorIDs":[2004954],"outputConnectorIDs":[2004952],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CALCULATE etl columns"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sysdate"},"2":{"slot":2,"type":"STRING","value":"created_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 00:00:00.000000'::timestamp"},"2":{"slot":2,"type":"STRING","value":"expiration_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dateadd(microsecond,-1,\"created_date\")"},"2":{"slot":2,"type":"STRING","value":"expiration_date_previous"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"true"},"2":{"slot":2,"type":"STRING","value":"current_record_ind"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"false"},"2":{"slot":2,"type":"STRING","value":"current_record_ind_previous"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"false"},"2":{"slot":2,"type":"STRING","value":"isdeleted"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004992":{"id":2004992,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":702,"y":202,"width":32,"height":32,"inputConnectorIDs":[2004959],"outputConnectorIDs":[2004956],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILTER for current & non-deleted & non-default rows"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current_record_ind"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"true"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"isdeleted"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"false"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_system"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"canals_japan"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004993":{"id":2004993,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":384,"y":304,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004957],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE stg1_canals_japan_fact_financial_metrics"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_canals_japan_fact_financial_metrics"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"business_expense_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_table"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"approval_week_ending_sunday"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"working_week_ending_sunday"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"revenue_amount"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"fee_code_id"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"canals_approval_date"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"cost_amount"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_regular_hours"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"employee_person_id"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"currency_id"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"exchange_rate_id"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"order_sk"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"market_sk"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"currency_sk"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"employee_sk"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"source_system"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"approval_week_ending_sunday_sk"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"working_week_ending_sunday_sk"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"client_id"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"client_sk"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"project_id"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"project_sk"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004994":{"id":2004994,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":560,"y":304,"width":32,"height":32,"inputConnectorIDs":[2004957],"outputConnectorIDs":[2004953],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate Hash Column"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"md5(\ncoalesce(timecard_id::varchar(max),'') || '^' ||\ncoalesce(business_expense_id::varchar(max),'') || '^' ||\ncoalesce(source_table::varchar(max),'') || '^' ||\ncoalesce(order_id::varchar(max),'') || '^' ||\ncoalesce(approval_week_ending_sunday::varchar(max),'') || '^' ||\ncoalesce(working_week_ending_sunday::varchar(max),'') || '^' ||\ncoalesce(revenue_amount::varchar(max),'') || '^' ||\ncoalesce(fee_code_id::varchar(max),'') || '^' ||\ncoalesce(canals_approval_date::varchar(max),'') || '^' ||\ncoalesce(cost_amount::varchar(max),'') || '^' ||\ncoalesce(timecard_regular_hours::varchar(max),'') || '^' ||\ncoalesce(market_id::varchar(max),'') || '^' ||\ncoalesce(employee_person_id::varchar(max),'') || '^' ||\ncoalesce(currency_id::varchar(max),'') || '^' ||\ncoalesce(exchange_rate_id::varchar(max),'') || '^' ||\ncoalesce(source_system::varchar(max),'')\n)"},"2":{"slot":2,"type":"STRING","value":"hash_full"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004995":{"id":2004995,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":702,"y":298,"width":32,"height":32,"inputConnectorIDs":[2004953,2004956],"outputConnectorIDs":[2004955],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILTER for current & non-deleted & non-default rows"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_system"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"business_expense_id"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"hash_full"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_source_table"},"2":{"slot":2,"type":"STRING","value":"source_table"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_order_id"},"2":{"slot":2,"type":"STRING","value":"order_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_working_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_revenue_amount"},"2":{"slot":2,"type":"STRING","value":"revenue_amount"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_fee_code_id"},"2":{"slot":2,"type":"STRING","value":"fee_code_id"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_canals_approval_date"},"2":{"slot":2,"type":"STRING","value":"canals_approval_date"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_cost_amount"},"2":{"slot":2,"type":"STRING","value":"cost_amount"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_timecard_regular_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_regular_hours"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_market_id"},"2":{"slot":2,"type":"STRING","value":"market_id"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_employee_person_id"},"2":{"slot":2,"type":"STRING","value":"employee_person_id"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_currency_id"},"2":{"slot":2,"type":"STRING","value":"currency_id"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"compare_exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"exchange_rate_id"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_order_sk"},"2":{"slot":2,"type":"STRING","value":"order_sk"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"compare_market_sk"},"2":{"slot":2,"type":"STRING","value":"market_sk"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"compare_currency_sk"},"2":{"slot":2,"type":"STRING","value":"currency_sk"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"compare_employee_sk"},"2":{"slot":2,"type":"STRING","value":"employee_sk"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"compare_source_system_sk"},"2":{"slot":2,"type":"STRING","value":"source_system_sk"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"compare_approval_week_ending_sunday_sk"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_sk"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"compare_working_week_ending_sunday_sk"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday_sk"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"compare_hash_full"},"2":{"slot":2,"type":"STRING","value":"hash_full"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"compare_client_id"},"2":{"slot":2,"type":"STRING","value":"client_id"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"compare_client_sk"},"2":{"slot":2,"type":"STRING","value":"client_sk"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"compare_project_id"},"2":{"slot":2,"type":"STRING","value":"project_id"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"compare_project_sk"},"2":{"slot":2,"type":"STRING","value":"project_sk"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"master_financial_metrics_sk"},"2":{"slot":2,"type":"STRING","value":"previous_sk"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004996":{"id":2004996,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1200,"y":304,"width":32,"height":32,"inputConnectorIDs":[2004952],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REWRITE int_canals_japan_fact_financial_metrics"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"int_canals_japan_fact_financial_metrics"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004997":{"id":2004997,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":702,"y":138,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004959],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_financial_metrics"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_financial_metrics"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"financial_metrics_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"current_record_ind"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"isdeleted"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"hash_full"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"source_system"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_id"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"business_expense_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004999":{"id":2004999,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":848,"y":304,"width":32,"height":32,"inputConnectorIDs":[2004955],"outputConnectorIDs":[2004954],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter for New/Change"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"2004952":{"id":2004952,"sourceID":2004958,"targetID":2004996},"2004953":{"id":2004953,"sourceID":2004994,"targetID":2004995},"2004954":{"id":2004954,"sourceID":2004999,"targetID":2004958},"2004955":{"id":2004955,"sourceID":2004995,"targetID":2004999},"2004956":{"id":2004956,"sourceID":2004992,"targetID":2004995},"2004957":{"id":2004957,"sourceID":2004993,"targetID":2004994},"2004959":{"id":2004959,"sourceID":2004997,"targetID":2004992}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"stage2_canals_japan_int_fact_financial_metrics_rewrite","description":"","type":"TRANSFORMATION","tag":"90de06b3-8088-4a04-a1b1-f1f25db53e75"}}