{"job":{"components":{"2005101":{"id":2005101,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":1104,"y":320,"width":32,"height":32,"inputConnectorIDs":[2005167],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2005163],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If dupe agg key exists - ROBOHEAD"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005102":{"id":2005102,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":560,"y":0,"width":32,"height":32,"inputConnectorIDs":[2005170],"outputSuccessConnectorIDs":[2005172],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage2_fact_financial_metric_gross_profit_aggregation_rewrite"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage2_fact_financial_metric_gross_profit_aggregation_rewrite"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005103":{"id":2005103,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":960,"y":320,"width":32,"height":32,"inputConnectorIDs":[2005173],"outputSuccessConnectorIDs":[2005167],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for dupe key in agg table - ROBOHEAD"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with cte as (\n\tselect count(*) as count\n\tfrom reporting.fact_financial_metric_gross_profit_aggregation\n  \twhere source_system = 'robohead'\n\tgroup by employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,project_id,engagement_id,client_id,invoice_week_ending_sunday,cost_ratio\n\thaving count(*) > 1\n\t\n\tunion all\n\t\n\tselect 0 as count -- needed when main query returns no data\n  )\nselect sum(count) as count\nfrom cte"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"count"}}}},"visible":true},"5":{"slot":5,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005104":{"id":2005104,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":960,"y":80,"width":32,"height":32,"inputConnectorIDs":[2005171],"outputSuccessConnectorIDs":[2005164],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for dupe key in staging table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with cte as (\n\tselect count(*) as count\n\tfrom staging.stg2_fact_financial_metric_gross_profit_aggregation\n\twhere not (bench_cost <> 0 or practice_group_bench_cost <> 0)\n    group by financial_metrics_sk\n\thaving count(*) > 1\n\t\n\tunion all\n\t\n\tselect 0 as count -- needed when main query returns no data\n  )\nselect sum(count) as count\nfrom cte"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"count"}}}},"visible":true},"5":{"slot":5,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005105":{"id":2005105,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":1248,"y":320,"width":32,"height":32,"inputConnectorIDs":[2005163],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message - dupe agg key - ROBOHEAD"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DSG-Admin"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(${ev_instance_project_name}) Dupes for ROBOHEAD in reporting.fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Use the below query to review dupe keys\n          select o.*\n          from reporting.fact_financial_metric_gross_profit_aggregation o\n          inner join (select employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,project_id,engagement_id,client_id,invoice_week_ending_sunday,cost_ratio\n                      from reporting.fact_financial_metric_gross_profit_aggregation\n\t\t\t\t\t  where source_system = 'robohead'\n\t\t\t\t\t  group by employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,project_id,engagement_id,client_id,invoice_week_ending_sunday,cost_ratio\n                      having count(1) > 1\n                     ) i on i.employee_person_id          = o.employee_person_id\n                        and i.approval_week_ending_sunday = o.approval_week_ending_sunday\n                        and i.working_week_ending_sunday  = o.working_week_ending_sunday\n                        and i.project_id                  = o.project_id\n                        and i.engagement_id               = o.engagement_id\n                        and i.client_id                   = o.client_id\n                        and i.invoice_week_ending_sunday  = o.invoice_week_ending_sunday\n                        and i.cost_ratio                  = o.cost_ratio\n          order by o.employee_person_id,o.approval_week_ending_sunday,o.working_week_ending_sunday,o.project_id,o.engagement_id,client_id,o.invoice_week_ending_sunday,cost_ratio;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005106":{"id":2005106,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":1248,"y":400,"width":32,"height":32,"inputConnectorIDs":[2005158],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message - dupe agg key - SCOUT"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DSG-Admin"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(${ev_instance_project_name}) Dupes for SCOUT in reporting.fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Use the below query to review dupe keys\n          select o.*\n          from reporting.fact_financial_metric_gross_profit_aggregation o\n          inner join (select employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,placement_id,scout_product_id,invoice_week_ending_sunday\n                      from reporting.fact_financial_metric_gross_profit_aggregation\n\t\t\t\t\t  where source_system = 'scout'\n\t\t\t\t\t  group by employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,placement_id,scout_product_id,invoice_week_ending_sunday\n                      having count(1) > 1\n                     ) i on i.employee_person_id          = o.employee_person_id\n                        and i.approval_week_ending_sunday = o.approval_week_ending_sunday\n                        and i.working_week_ending_sunday  = o.working_week_ending_sunday\n                        and i.placement_id                = o.placement_id\n                        and i.scout_product_id            = o.scout_product_id\n                        and i.invoice_week_ending_sunday  = o.invoice_week_ending_sunday\n          order by o.employee_person_id,o.approval_week_ending_sunday,o.working_week_ending_sunday,o.placement_id,o.scout_product_id,o.invoice_week_ending_sunday"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005107":{"id":2005107,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":1248,"y":80,"width":32,"height":32,"inputConnectorIDs":[2005159],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message - dupe staging key"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DSG-Admin"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(${ev_instance_project_name}) Dupes in staging.stg2_fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Use the below query to review dupe keys\n          select o.*\n          from staging.stg2_fact_financial_metric_gross_profit_aggregation o\n          inner join (select financial_metrics_sk\n                       from staging.stg2_fact_financial_metric_gross_profit_aggregation\n                       where not (bench_cost <> 0 or practice_group_bench_cost <> 0)\n                       group by financial_metrics_sk\n                       having count(1) > 1\n                     ) i on i.financial_metrics_sk = o.financial_metrics_sk\n          order by o.financial_metrics_sk;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005108":{"id":2005108,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":1248,"y":160,"width":32,"height":32,"inputConnectorIDs":[2005161],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message - dupe agg key - CANALS_JAPAN"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DSG-Admin"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(${ev_instance_project_name}) Dupes for CANALS_JAPAN in reporting.fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Use the below query to review dupe keys\n          select o.*\n          from reporting.fact_financial_metric_gross_profit_aggregation o\n          inner join (select employee_person_id, approval_week_ending_sunday, working_week_ending_sunday, order_id\n                       from reporting.fact_financial_metric_gross_profit_aggregation\n                       where source_system = 'canals_japan'\n                         and not (bench_cost <> 0 or practice_group_bench_cost <> 0)\n                       group by employee_person_id, approval_week_ending_sunday, working_week_ending_sunday, order_id\n                       having count(1) > 1\n                     ) i on i.employee_person_id          = o.employee_person_id\n                        and i.approval_week_ending_sunday = o.approval_week_ending_sunday\n                        and i.working_week_ending_sunday  = o.working_week_ending_sunday\n                        and i.order_id                    = o.order_id\n          order by o.employee_person_id,o.approval_week_ending_sunday,o.working_week_ending_sunday,o.order_id;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005109":{"id":2005109,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":960,"y":160,"width":32,"height":32,"inputConnectorIDs":[2005162],"outputSuccessConnectorIDs":[2005175],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for dupe key in agg table - CANALS_JAPAN"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with cte as (\n\tselect count(*) as count\n\tfrom reporting.fact_financial_metric_gross_profit_aggregation\n  \twhere source_system = 'canals_japan'\n      and not (bench_cost <> 0 or practice_group_bench_cost <> 0)\n\tgroup by employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,order_id\n\thaving count(*) > 1\n\t\n\tunion all\n\t\n\tselect 0 as count -- needed when main query returns no data\n  )\nselect sum(count) as count\nfrom cte"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"count"}}}},"visible":true},"5":{"slot":5,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005151":{"id":2005151,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":960,"y":400,"width":32,"height":32,"inputConnectorIDs":[2005166],"outputSuccessConnectorIDs":[2005168],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for dupe key in agg table - SCOUT"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with cte as (\n\tselect count(*) as count\n\tfrom reporting.fact_financial_metric_gross_profit_aggregation\n  \twhere source_system = 'scout'\n\tgroup by employee_person_id,working_week_ending_sunday,approval_week_ending_sunday,placement_id,scout_product_id,invoice_week_ending_sunday\n\thaving count(*) > 1\n\t\n\tunion all\n\t\n\tselect 0 as count -- needed when main query returns no data\n  )\nselect sum(count) as count\nfrom cte\n"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"count"}}}},"visible":true},"5":{"slot":5,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005174":{"id":2005174,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":896,"y":0,"width":32,"height":32,"inputConnectorIDs":[2005172],"outputSuccessConnectorIDs":[2005162,2005165,2005166,2005171,2005173],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target_fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target_fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005176":{"id":2005176,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":208,"y":0,"width":32,"height":32,"inputConnectorIDs":[2005156],"outputSuccessConnectorIDs":[2005170],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage1_fact_financial_metric_gross_profit_aggregation_rewrite"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage1_fact_financial_metric_gross_profit_aggregation_rewrite"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005177":{"id":2005177,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":1104,"y":80,"width":32,"height":32,"inputConnectorIDs":[2005164],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2005159],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If dupe staging key exists"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005178":{"id":2005178,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":1104,"y":240,"width":32,"height":32,"inputConnectorIDs":[2005169],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2005160],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If dupe agg key exists - CLOUDWALL"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005179":{"id":2005179,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2005156],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005180":{"id":2005180,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":1104,"y":160,"width":32,"height":32,"inputConnectorIDs":[2005175],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2005161],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If dupe agg key exists - CANALS_JAPAN"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005181":{"id":2005181,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":960,"y":240,"width":32,"height":32,"inputConnectorIDs":[2005165],"outputSuccessConnectorIDs":[2005169],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check for dupe key in agg table - CLOUDWALL"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with cte as (\n\tselect count(*) as count\n\tfrom reporting.fact_financial_metric_gross_profit_aggregation\n  \twhere source_system = 'cloudwall'\n      and not (bench_cost <> 0 or practice_group_bench_cost <> 0)\n\tgroup by employee_person_id,approval_week_ending_sunday,working_week_ending_sunday,order_id,invoice_week_ending_sunday\n\thaving count(*) > 1\n\t\n\tunion all\n\t\n\tselect 0 as count -- needed when main query returns no data\n  )\nselect sum(count) as count\nfrom cte"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"count"}}}},"visible":true},"5":{"slot":5,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005182":{"id":2005182,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":1104,"y":400,"width":32,"height":32,"inputConnectorIDs":[2005168],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2005158],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If dupe agg key exists - SCOUT"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jv_dupe_key_count"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2005183":{"id":2005183,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":1248,"y":240,"width":32,"height":32,"inputConnectorIDs":[2005160],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message - dupe agg key - CLOUDWALL"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DSG-Admin"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(${ev_instance_project_name}) Dupes for CLOUDWALL in reporting.fact_financial_metric_gross_profit_aggregation"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Use the below query to review dupe keys\n          select o.*\n          from reporting.fact_financial_metric_gross_profit_aggregation o\n          inner join (select employee_person_id, approval_week_ending_sunday, working_week_ending_sunday, order_id, invoice_week_ending_sunday\n                       from reporting.fact_financial_metric_gross_profit_aggregation\n                       where source_system = 'cloudwall'\n                         and not (bench_cost <> 0 or practice_group_bench_cost <> 0)\n                       group by employee_person_id, approval_week_ending_sunday, working_week_ending_sunday, order_id, invoice_week_ending_sunday\n                       having count(1) > 1\n                     ) i on i.employee_person_id          = o.employee_person_id\n                        and i.approval_week_ending_sunday = o.approval_week_ending_sunday\n                        and i.working_week_ending_sunday  = o.working_week_ending_sunday\n                        and i.order_id                    = o.order_id\n                        and i.invoice_week_ending_sunday  = o.invoice_week_ending_sunday\n          order by o.employee_person_id,o.approval_week_ending_sunday,o.working_week_ending_sunday,o.order_id,o.invoice_week_ending_sunday;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2005162":{"id":2005162,"sourceID":2005174,"targetID":2005109},"2005164":{"id":2005164,"sourceID":2005104,"targetID":2005177},"2005165":{"id":2005165,"sourceID":2005174,"targetID":2005181},"2005166":{"id":2005166,"sourceID":2005174,"targetID":2005151},"2005167":{"id":2005167,"sourceID":2005103,"targetID":2005101},"2005168":{"id":2005168,"sourceID":2005151,"targetID":2005182},"2005169":{"id":2005169,"sourceID":2005181,"targetID":2005178},"2005170":{"id":2005170,"sourceID":2005176,"targetID":2005102},"2005171":{"id":2005171,"sourceID":2005174,"targetID":2005104},"2005172":{"id":2005172,"sourceID":2005102,"targetID":2005174},"2005173":{"id":2005173,"sourceID":2005174,"targetID":2005103},"2005175":{"id":2005175,"sourceID":2005109,"targetID":2005180}},"failureConnectors":{},"unconditionalConnectors":{"2005156":{"id":2005156,"sourceID":2005179,"targetID":2005176}},"trueConnectors":{"2005158":{"id":2005158,"sourceID":2005182,"targetID":2005106},"2005159":{"id":2005159,"sourceID":2005177,"targetID":2005107},"2005160":{"id":2005160,"sourceID":2005178,"targetID":2005183},"2005161":{"id":2005161,"sourceID":2005180,"targetID":2005108},"2005163":{"id":2005163,"sourceID":2005101,"targetID":2005105}},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"jv_dupe_key_count":{"definition":{"name":"jv_dupe_key_count","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"0"},"jv_new_burden":{"definition":{"name":"jv_new_burden","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"0"}},"grids":{}},"info":{"name":"fact_financial_metric_gross_profit_aggregation","description":"","type":"ORCHESTRATION","tag":"501dea2e-f3b1-4523-8cd1-6523351c49ae"}}