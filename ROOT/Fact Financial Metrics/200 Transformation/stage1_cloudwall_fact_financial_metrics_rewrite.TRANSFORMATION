{"job":{"components":{"2004320":{"id":2004320,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":160,"y":64,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004398],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card1"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card1"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"time_card_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"order_position_id"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"week_ending_sunday"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"emp_person_id"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rebate_amount"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"order_invoice_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004321":{"id":2004321,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":416,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004354],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card3"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card3"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"time_card_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"adp_batch_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"is_robohead_timecard"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004322":{"id":2004322,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":510,"y":470,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004391],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_benefit_hour_adjustment"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_benefit_hour_adjustment"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"benefit_hour_adjustment_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"hours"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004323":{"id":2004323,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":160,"y":384,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004361],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_business_expense"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_business_expense"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"business_expense_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"order_position_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"order_invoice_id"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"week_ending_sunday"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"fee_code_id"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"person_id"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"client_amount"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"employee_amount"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"rebate_amount"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"adp_batch_id"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"benefit_hour_adjustment_id"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"is_robohead_business_expense"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"approved"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"home_division_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004324":{"id":2004324,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1152,"y":384,"width":32,"height":32,"inputConnectorIDs":[2004390],"outputConnectorIDs":[2004415],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calc columns business_expense"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'business_expense'::varchar(255)"},"2":{"slot":2,"type":"STRING","value":"source_table"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(approval_week_ending_sunday::date,approval_week_ending_sunday_nontc::date)"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"working_week_ending_sunday::date"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"revenue_amount\"::NUMERIC(21,4),0)"},"2":{"slot":2,"type":"STRING","value":"revenue_amount"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"cost_amount\"::NUMERIC(21,4),0)"},"2":{"slot":2,"type":"STRING","value":"cost_amount"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"rebate_amount\"::NUMERIC(21,4),0)"},"2":{"slot":2,"type":"STRING","value":"rebate_amount"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"tax_amount\",0)"},"2":{"slot":2,"type":"STRING","value":"tax_amount"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(approval_week_ending_sunday_sk,approval_week_ending_sunday_sk_nontc)"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_sk"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004325":{"id":2004325,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1632,"y":224,"width":32,"height":32,"inputConnectorIDs":[2004384],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REWRITE stg1_cloudwall_fact_financial_metrics"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_cloudwall_fact_financial_metrics"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004326":{"id":2004326,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-1841822228,"x":1392,"y":224,"width":32,"height":32,"inputConnectorIDs":[2004351,2004415],"outputConnectorIDs":[2004366],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UNION ALL"}}}},"visible":true},"2":{"slot":2,"name":"Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All Columns"}}}},"visible":true},"3":{"slot":3,"name":"Cast Types","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Add Source Component Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Remove duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004327":{"id":2004327,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":1024,"y":64,"width":32,"height":32,"inputConnectorIDs":[2004352,2004353,2004354,2004355,2004356,2004357,2004362,2004365,2004369,2004371,2004385,2004387,2004399,2004410,2004411,2004413,2004414],"outputConnectorIDs":[2004397],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join time_card"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exclude robohead time cards"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card2"},"2":{"slot":2,"type":"STRING","value":"jtc2"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card3"},"2":{"slot":2,"type":"STRING","value":"jtc3"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_order"},"2":{"slot":2,"type":"STRING","value":"jo"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_invoice"},"2":{"slot":2,"type":"STRING","value":"oi"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_market"},"2":{"slot":2,"type":"STRING","value":"ma"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_country"},"2":{"slot":2,"type":"STRING","value":"co"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency"},"2":{"slot":2,"type":"STRING","value":"cu"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency_exchange_rate"},"2":{"slot":2,"type":"STRING","value":"ex"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_adp_batch"},"2":{"slot":2,"type":"STRING","value":"adp"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"dim_source_system"},"2":{"slot":2,"type":"STRING","value":"rdss"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_work"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_app"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"dim_market"},"2":{"slot":2,"type":"STRING","value":"rdm"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"Distinct dim_order"},"2":{"slot":2,"type":"STRING","value":"rdo"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"dim_currency"},"2":{"slot":2,"type":"STRING","value":"rdc"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"dim_employee"},"2":{"slot":2,"type":"STRING","value":"rde"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"dim_client"},"2":{"slot":2,"type":"STRING","value":"rdl"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_inv"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.time_card_id = jtc1.time_card_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_jtc2"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"jtc3.time_card_id = jtc1.time_card_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_jtc3"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jo.order_id = jtc1.order_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_jo"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.order_invoice_id = oi.order_invoice_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_oi"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ma.market_id = jo.market_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_ma"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"co.country_id = ma.country_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_co"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"cu.currency_id = co.currency_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_cu"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ex.currency_id = cu.currency_id \nand jtc1.week_ending_sunday >= ex.start_date \nand jtc1.week_ending_sunday < ex.end_date"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_ex"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"\"jtc3\".\"adp_batch_id\" = \"adp\".\"adp_batch_id\""},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_adp"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"true and rdss.source_system_name = 'cloudwall'"},"2":{"slot":2,"type":"STRING","value":"jtc1_Inner_rdss"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"\"jtc1\".\"week_ending_sunday\" = \"rdd_work\".\"calendar_date\""},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdd_work"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"\"adp\".\"week_ending_sunday\" = \"rdd_app\".\"calendar_date\""},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdd_app"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"rdm.market_id = jo.market_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdm"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"\trdo.order_id \t\t   = jtc1.order_id \nand rdo.order_position_id  = jtc1.order_position_id \nand rdo.source_system_sk   = rdss.source_system_sk \nand rdo.current_record_ind = true"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdo"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"    rdc.current_record_ind = true\nand rdc.source_system_sk   = rdss.source_system_sk\nand rdc.currency_id        = cu.currency_id\nand rdc.exchange_rate_id   = ex.currency_exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdc"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"    rde.cloudwall_talent_id = jtc1.emp_person_id \nand rde.current_record_ind = true\nand\trde.rank_num = 1"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rde"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"    rdl.current_record_ind = true\nand rdl.source_system_sk   = rdss.source_system_sk\nand rdl.source_client_id   = jo.client_id\nand rdl.market_id          = jo.market_id"},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdl"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"\"oi\".\"order_invoice_date\"::date = \"rdd_inv\".\"calendar_date\""},"2":{"slot":2,"type":"STRING","value":"jtc1_Left_rdd_inv"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rdss.source_system_sk"},"2":{"slot":2,"type":"STRING","value":"source_system_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"rdss.source_system_name"},"2":{"slot":2,"type":"STRING","value":"source_system"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"rde.employee_sk"},"2":{"slot":2,"type":"STRING","value":"employee_sk"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_app.date_sk"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_sk"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_work.date_sk"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday_sk"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rdo.order_sk"},"2":{"slot":2,"type":"STRING","value":"order_sk"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"rdl.client_sk"},"2":{"slot":2,"type":"STRING","value":"client_sk"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"rdm.market_sk"},"2":{"slot":2,"type":"STRING","value":"market_sk"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"rdc.currency_sk"},"2":{"slot":2,"type":"STRING","value":"currency_sk"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.time_card_id"},"2":{"slot":2,"type":"STRING","value":"timecard_id"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"jtc3.adp_batch_id"},"2":{"slot":2,"type":"STRING","value":"payroll_batch_id"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"adp.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.emp_person_id"},"2":{"slot":2,"type":"STRING","value":"employee_person_id"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.order_id"},"2":{"slot":2,"type":"STRING","value":"order_id"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.order_invoice_id"},"2":{"slot":2,"type":"STRING","value":"order_invoice_id"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"jo.client_id"},"2":{"slot":2,"type":"STRING","value":"client_id"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"jo.market_id"},"2":{"slot":2,"type":"STRING","value":"market_id"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"cu.currency_id"},"2":{"slot":2,"type":"STRING","value":"currency_id"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"ex.currency_exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"exchange_rate_id"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"jtc1.rebate_amount"},"2":{"slot":2,"type":"STRING","value":"rebate_amount"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.billing_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_bill_rate"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.overtime_billing_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_bill_rate"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.other_billing_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_other_bill_rate"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.employee_pay_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_pay_rate"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.employee_overtime_pay_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_pay_rate"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.employee_other_pay_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_other_pay_rate"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.total_regular_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_regular_hours"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.total_overtime_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_hours"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.total_double_time_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_double_time_hours"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.total_other_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_other_hours"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.total_overtime_1_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_1_hours"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"jtc2.total_overtime_2_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_2_hours"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"jo.payroll_transfer"},"2":{"slot":2,"type":"STRING","value":"jo.payroll_transfer"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"oi.discount"},"2":{"slot":2,"type":"STRING","value":"invoiced_discount_amount"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"oi.order_invoice_date"},"2":{"slot":2,"type":"STRING","value":"order_invoice_date"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_inv.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"invoice_week_ending_sunday"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004328":{"id":2004328,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":1024,"y":384,"width":32,"height":32,"inputConnectorIDs":[2004358,2004359,2004360,2004363,2004364,2004367,2004368,2004386,2004388,2004389,2004391,2004392,2004393,2004394,2004395,2004396,2004400],"outputConnectorIDs":[2004390],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join business_expense"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exclude robohead business expenses"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"be"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_invoice"},"2":{"slot":2,"type":"STRING","value":"oi"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_position"},"2":{"slot":2,"type":"STRING","value":"op"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_order"},"2":{"slot":2,"type":"STRING","value":"jo"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_market"},"2":{"slot":2,"type":"STRING","value":"ma"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_country"},"2":{"slot":2,"type":"STRING","value":"co"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency"},"2":{"slot":2,"type":"STRING","value":"cu"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency_exchange_rate"},"2":{"slot":2,"type":"STRING","value":"ex"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_adp_batch"},"2":{"slot":2,"type":"STRING","value":"adp"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_benefit_hour_adjustment"},"2":{"slot":2,"type":"STRING","value":"bha"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"dim_source_system"},"2":{"slot":2,"type":"STRING","value":"rdss"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_work"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_app"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"dim_market"},"2":{"slot":2,"type":"STRING","value":"rdm"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"Distinct dim_order"},"2":{"slot":2,"type":"STRING","value":"rdo"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"dim_currency"},"2":{"slot":2,"type":"STRING","value":"rdc"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"dim_employee"},"2":{"slot":2,"type":"STRING","value":"rde"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"dim_client"},"2":{"slot":2,"type":"STRING","value":"rdl"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_inv"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_app_nontc"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"},"2":{"slot":2,"type":"STRING","value":"rdd_app_sk_nontc"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"oi.order_invoice_id = be.order_invoice_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_oi"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"op.order_position_id = be.order_position_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_op"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jo.order_id = op.order_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_jo"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ma.market_id = jo.market_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_ma"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"co.country_id = ma.country_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_co"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"cu.currency_id = co.currency_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_cu"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"    ex.currency_id = cu.currency_id \nand be.week_ending_sunday >= ex.start_date \nand be.week_ending_sunday <  ex.end_date"},"2":{"slot":2,"type":"STRING","value":"be_Left_ex"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"\"be\".\"adp_batch_id\" = \"adp\".\"adp_batch_id\""},"2":{"slot":2,"type":"STRING","value":"be_Left_adp"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"\"be\".\"benefit_hour_adjustment_id\" = \"bha\".\"benefit_hour_adjustment_id\""},"2":{"slot":2,"type":"STRING","value":"be_Left_bha"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"rdss.source_system_name = 'cloudwall'"},"2":{"slot":2,"type":"STRING","value":"be_Inner_rdss"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"\"be\".\"week_ending_sunday\" = \"rdd_work\".\"calendar_date\""},"2":{"slot":2,"type":"STRING","value":"be_Left_rdd_work"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"\"adp\".\"week_ending_sunday\"::date = \"rdd_app\".\"calendar_date\""},"2":{"slot":2,"type":"STRING","value":"be_Left_rdd_app"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"rdm.market_id = jo.market_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_rdm"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"    rdo.current_record_ind = true\nand rdo.source_system_sk   = rdss.source_system_sk\nand rdo.order_id           = op.order_id\nand rdo.order_position_id  = be.order_position_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_rdo"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"    rdc.current_record_ind = true\nand rdc.source_system_sk   = rdss.source_system_sk\nand rdc.currency_id        = cu.currency_id\nand rdc.exchange_rate_id   = ex.currency_exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_rdc"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"    rde.cloudwall_talent_id = be.person_id \nand rde.current_record_ind = true\nand\trde.rank_num = 1"},"2":{"slot":2,"type":"STRING","value":"be_Left_rde"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"    rdl.current_record_ind = true\nand rdl.source_system_sk   = rdss.source_system_sk\nand rdl.source_client_id   = jo.client_id\nand rdl.market_id          = jo.market_id"},"2":{"slot":2,"type":"STRING","value":"be_Left_rdl"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"\"oi\".\"order_invoice_date\"::date = \"rdd_inv\".\"calendar_date\""},"2":{"slot":2,"type":"STRING","value":"be_Left_rdd_inv"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"be.approved::date = rdd_app_nontc.calendar_date"},"2":{"slot":2,"type":"STRING","value":"be_Left_rdd_app_nontc"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_app_nontc.week_ending_sunday = rdd_app_sk_nontc.calendar_date"},"2":{"slot":2,"type":"STRING","value":"be_Left_rdd_app_sk_nontc"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rdss.source_system_sk"},"2":{"slot":2,"type":"STRING","value":"source_system_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"rdss.source_system_name"},"2":{"slot":2,"type":"STRING","value":"source_system"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"rde.employee_sk"},"2":{"slot":2,"type":"STRING","value":"employee_sk"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_app.date_sk"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_sk"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_work.date_sk"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday_sk"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"rdo.order_sk"},"2":{"slot":2,"type":"STRING","value":"order_sk"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"rdl.client_sk"},"2":{"slot":2,"type":"STRING","value":"client_sk"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"rdm.market_sk"},"2":{"slot":2,"type":"STRING","value":"market_sk"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"rdc.currency_sk"},"2":{"slot":2,"type":"STRING","value":"currency_sk"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"be.fee_code_id"},"2":{"slot":2,"type":"STRING","value":"fee_code_id"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"be.business_expense_id"},"2":{"slot":2,"type":"STRING","value":"business_expense_id"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"be.adp_batch_id"},"2":{"slot":2,"type":"STRING","value":"payroll_batch_id"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"adp.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"be.person_id"},"2":{"slot":2,"type":"STRING","value":"employee_person_id"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"be.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"op.order_id"},"2":{"slot":2,"type":"STRING","value":"order_id"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"be.order_invoice_id"},"2":{"slot":2,"type":"STRING","value":"order_invoice_id"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"jo.client_id"},"2":{"slot":2,"type":"STRING","value":"client_id"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"jo.market_id"},"2":{"slot":2,"type":"STRING","value":"market_id"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"cu.currency_id"},"2":{"slot":2,"type":"STRING","value":"currency_id"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"ex.currency_exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"exchange_rate_id"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"be.client_amount"},"2":{"slot":2,"type":"STRING","value":"revenue_amount"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"be.employee_amount"},"2":{"slot":2,"type":"STRING","value":"cost_amount"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"be.rebate_amount"},"2":{"slot":2,"type":"STRING","value":"rebate_amount"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"oi.tax_amount"},"2":{"slot":2,"type":"STRING","value":"tax_amount"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"jo.payroll_transfer"},"2":{"slot":2,"type":"STRING","value":"jo.payroll_transfer"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"bha.hours"},"2":{"slot":2,"type":"STRING","value":"hour_adjustment"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"oi.discount"},"2":{"slot":2,"type":"STRING","value":"invoiced_discount_amount"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"oi.order_invoice_date"},"2":{"slot":2,"type":"STRING","value":"order_invoice_date"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_inv.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"invoice_week_ending_sunday"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_app_nontc.week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_nontc"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"rdd_app_sk_nontc.date_sk"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_sk_nontc"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004329":{"id":2004329,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":768,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004353,2004364],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_date"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"date_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"calendar_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"week_ending_sunday"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004330":{"id":2004330,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":832,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004412],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_order"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_order"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"order_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"order_position_id"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"current_record_ind"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004331":{"id":2004331,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":672,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004355,2004367],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_source_system"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_source_system"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_name"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004332":{"id":2004332,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":304,"y":464,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004363],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_position"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_position"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"order_position_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004333":{"id":2004333,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":176,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004358,2004362],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_invoice"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_order_invoice"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"order_invoice_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"tax_amount"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"discount"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"order_invoice_date"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004334":{"id":2004334,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":336,"y":64,"width":32,"height":32,"inputConnectorIDs":[2004398],"outputConnectorIDs":[2004369],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exclude robohead time cards"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select jtc1.*\nfrom $T{raw_cloudwall_job_time_card1} jtc1\nleft join exploration.raw_cloudwall_job_time_card3 jtc3 on jtc1.time_card_id = jtc3.time_card_id\nleft join exploration.raw_cloudwall_timeslip ts on ts.time_card_id = jtc1.time_card_id\nwhere not (   coalesce(jtc3.home_division_id,0) in (30,40)\n           or ts.timeslip_id is not null\n          )\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004335":{"id":2004335,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":176,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004387,2004389],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_order"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_order"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"payroll_transfer"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"client_id"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004337":{"id":2004337,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":336,"y":384,"width":32,"height":32,"inputConnectorIDs":[2004361],"outputConnectorIDs":[2004359],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exclude robohead business expenses"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select be.*\nfrom ($T{raw_cloudwall_business_expense}) be\nleft join exploration.raw_cloudwall_order_position op on op.order_position_id = be.order_position_id\nwhere not (coalesce(be.home_division_id,0) in (30,40) or is_robohead_business_expense = true)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004370":{"id":2004370,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1744268877,"x":928,"y":224,"width":32,"height":32,"inputConnectorIDs":[2004412],"outputConnectorIDs":[2004396,2004399],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Distinct dim_order"}}}},"visible":true},"2":{"slot":2,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"order_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"order_position_id"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"current_record_ind"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004372":{"id":2004372,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":320,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004392,2004413],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_country"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_country"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"country_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"currency_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004373":{"id":2004373,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":1200,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004385,2004400],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_employee"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\t*\n\t,\trank()\tover\t(partition by cloudwall_talent_id order by effective_start_date desc,employment_status_id asc) as rank_num\nfrom\treporting.dim_employee\nwhere\tcurrent_record_ind\t=\ttrue"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004374":{"id":2004374,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":496,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004394,2004411],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"currency_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004375":{"id":2004375,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1488,"y":224,"width":32,"height":32,"inputConnectorIDs":[2004366],"outputConnectorIDs":[2004384],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Reorder Cols"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"},"2":{"slot":2,"type":"STRING","value":"source_system_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"source_system"},"2":{"slot":2,"type":"STRING","value":"source_system"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_table"},"2":{"slot":2,"type":"STRING","value":"source_table"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"employee_sk"},"2":{"slot":2,"type":"STRING","value":"employee_sk"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"approval_week_ending_sunday_sk"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday_sk"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"working_week_ending_sunday_sk"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday_sk"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"order_sk"},"2":{"slot":2,"type":"STRING","value":"order_sk"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"client_sk"},"2":{"slot":2,"type":"STRING","value":"client_sk"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"market_sk"},"2":{"slot":2,"type":"STRING","value":"market_sk"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"currency_sk"},"2":{"slot":2,"type":"STRING","value":"currency_sk"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"fee_code_id"},"2":{"slot":2,"type":"STRING","value":"fee_code_id"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_id"},"2":{"slot":2,"type":"STRING","value":"timecard_id"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"business_expense_id"},"2":{"slot":2,"type":"STRING","value":"business_expense_id"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"payroll_batch_id"},"2":{"slot":2,"type":"STRING","value":"payroll_batch_id"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"employee_person_id"},"2":{"slot":2,"type":"STRING","value":"employee_person_id"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"working_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"},"2":{"slot":2,"type":"STRING","value":"order_id"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"order_invoice_id"},"2":{"slot":2,"type":"STRING","value":"order_invoice_id"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"client_id"},"2":{"slot":2,"type":"STRING","value":"client_id"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"},"2":{"slot":2,"type":"STRING","value":"market_id"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"currency_id"},"2":{"slot":2,"type":"STRING","value":"currency_id"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"exchange_rate_id"},"2":{"slot":2,"type":"STRING","value":"exchange_rate_id"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"revenue_amount"},"2":{"slot":2,"type":"STRING","value":"revenue_amount"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"cost_amount"},"2":{"slot":2,"type":"STRING","value":"cost_amount"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"rebate_amount"},"2":{"slot":2,"type":"STRING","value":"rebate_amount"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"tax_amount"},"2":{"slot":2,"type":"STRING","value":"tax_amount"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_bill_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_bill_rate"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_bill_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_bill_rate"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_other_bill_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_other_bill_rate"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_pay_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_pay_rate"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_pay_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_pay_rate"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_other_pay_rate"},"2":{"slot":2,"type":"STRING","value":"timecard_other_pay_rate"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_regular_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_regular_hours"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_hours"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_double_time_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_double_time_hours"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_other_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_other_hours"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_1_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_1_hours"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"timecard_overtime_2_hours"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_2_hours"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"hour_adjustment"},"2":{"slot":2,"type":"STRING","value":"hour_adjustment"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"invoiced_discount_amount"},"2":{"slot":2,"type":"STRING","value":"invoiced_discount_amount"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"order_invoice_date"},"2":{"slot":2,"type":"STRING","value":"order_invoice_date"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"invoice_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"invoice_week_ending_sunday"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"jo.payroll_transfer"},"2":{"slot":2,"type":"STRING","value":"payroll_transfer"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004376":{"id":2004376,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1152,"y":64,"width":32,"height":32,"inputConnectorIDs":[2004397],"outputConnectorIDs":[2004351],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calc columns time_card"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'job_time_card'::varchar(255)"},"2":{"slot":2,"type":"STRING","value":"source_table"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"approval_week_ending_sunday::date"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"working_week_ending_sunday::date"},"2":{"slot":2,"type":"STRING","value":"working_week_ending_sunday"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"111::integer"},"2":{"slot":2,"type":"STRING","value":"fee_code_id"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(rebate_amount::numeric(21,4),0)"},"2":{"slot":2,"type":"STRING","value":"rebate_amount"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_bill_rate\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_bill_rate"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_overtime_bill_rate\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_bill_rate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_other_bill_rate\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_other_bill_rate"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_pay_rate\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_pay_rate"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_overtime_pay_rate\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_pay_rate"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_other_pay_rate\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_other_pay_rate"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_regular_hours\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_regular_hours"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_overtime_hours\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_hours"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_double_time_hours\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_double_time_hours"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_other_hours\",0)"},"2":{"slot":2,"type":"STRING","value":"timecard_other_hours"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_overtime_1_hours\"::numeric(19,4),0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_1_hours"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"coalesce(\"timecard_overtime_2_hours\"::numeric(19,4),0)"},"2":{"slot":2,"type":"STRING","value":"timecard_overtime_2_hours"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"(\n   (\"timecard_bill_rate\"          * \"timecard_regular_hours\")\n + (\"timecard_overtime_bill_rate\" * \"timecard_overtime_hours\")\n + (case \n\t    when coalesce(\"timecard_other_bill_rate\",0.0000) = 0.0000 \n            then (\"timecard_bill_rate\" * 2)\n        else \"timecard_other_bill_rate\" \n    end * \"timecard_double_time_hours\")\n)::numeric(21,4)"},"2":{"slot":2,"type":"STRING","value":"revenue_amount"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"(\n   (\"timecard_pay_rate\"          * \"timecard_regular_hours\")\n + (\"timecard_overtime_pay_rate\" * \"timecard_overtime_hours\")\n + (case \n\t    when coalesce(\"timecard_other_pay_rate\",0.0000) = 0.0000 \n            then (\"timecard_pay_rate\" * 2)\n        else \"timecard_other_pay_rate\" \n    end * \"timecard_double_time_hours\")\n)::numeric(21,4)"},"2":{"slot":2,"type":"STRING","value":"cost_amount"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004377":{"id":2004377,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":1104,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004357,2004386],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_currency"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_currency"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"currency_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"currency_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"current_record_ind"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"exchange_rate_start_date"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"exchange_rate_end_date"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"exchange_rate_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004378":{"id":2004378,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":1280,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004360,2004365],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_client"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_client"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current_record_ind"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"client_sk"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_system_sk"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"source_client_id"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004379":{"id":2004379,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":1024,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004352,2004388],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_market"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_market"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"market_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"reporting"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004380":{"id":2004380,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":320,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004393,2004414],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_market"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_market"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"country_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"market_id"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004381":{"id":2004381,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":80,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004368,2004371],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_adp_batch"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_adp_batch"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"adp_batch_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"week_ending_sunday"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004382":{"id":2004382,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":304,"y":-32,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004356],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card2"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_job_time_card2"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"time_card_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"billing_rate"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"overtime_billing_rate"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"other_billing_rate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"employee_pay_rate"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"employee_overtime_pay_rate"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"employee_other_pay_rate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"total_regular_hours"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"total_overtime_hours"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"total_double_time_hours"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"total_other_hours"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"total_overtime_1_hours"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"total_overtime_2_hours"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004383":{"id":2004383,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":496,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004395,2004410],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency_exchange_rate"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_cloudwall_currency_exchange_rate"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"currency_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"currency_exchange_rate_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"start_date"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"end_date"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"exploration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"2004351":{"id":2004351,"sourceID":2004376,"targetID":2004326},"2004352":{"id":2004352,"sourceID":2004379,"targetID":2004327},"2004353":{"id":2004353,"sourceID":2004329,"targetID":2004327},"2004354":{"id":2004354,"sourceID":2004321,"targetID":2004327},"2004355":{"id":2004355,"sourceID":2004331,"targetID":2004327},"2004356":{"id":2004356,"sourceID":2004382,"targetID":2004327},"2004357":{"id":2004357,"sourceID":2004377,"targetID":2004327},"2004358":{"id":2004358,"sourceID":2004333,"targetID":2004328},"2004359":{"id":2004359,"sourceID":2004337,"targetID":2004328},"2004360":{"id":2004360,"sourceID":2004378,"targetID":2004328},"2004361":{"id":2004361,"sourceID":2004323,"targetID":2004337},"2004362":{"id":2004362,"sourceID":2004333,"targetID":2004327},"2004363":{"id":2004363,"sourceID":2004332,"targetID":2004328},"2004364":{"id":2004364,"sourceID":2004329,"targetID":2004328},"2004365":{"id":2004365,"sourceID":2004378,"targetID":2004327},"2004366":{"id":2004366,"sourceID":2004326,"targetID":2004375},"2004367":{"id":2004367,"sourceID":2004331,"targetID":2004328},"2004368":{"id":2004368,"sourceID":2004381,"targetID":2004328},"2004369":{"id":2004369,"sourceID":2004334,"targetID":2004327},"2004371":{"id":2004371,"sourceID":2004381,"targetID":2004327},"2004384":{"id":2004384,"sourceID":2004375,"targetID":2004325},"2004385":{"id":2004385,"sourceID":2004373,"targetID":2004327},"2004386":{"id":2004386,"sourceID":2004377,"targetID":2004328},"2004387":{"id":2004387,"sourceID":2004335,"targetID":2004327},"2004388":{"id":2004388,"sourceID":2004379,"targetID":2004328},"2004389":{"id":2004389,"sourceID":2004335,"targetID":2004328},"2004390":{"id":2004390,"sourceID":2004328,"targetID":2004324},"2004391":{"id":2004391,"sourceID":2004322,"targetID":2004328},"2004392":{"id":2004392,"sourceID":2004372,"targetID":2004328},"2004393":{"id":2004393,"sourceID":2004380,"targetID":2004328},"2004394":{"id":2004394,"sourceID":2004374,"targetID":2004328},"2004395":{"id":2004395,"sourceID":2004383,"targetID":2004328},"2004396":{"id":2004396,"sourceID":2004370,"targetID":2004328},"2004397":{"id":2004397,"sourceID":2004327,"targetID":2004376},"2004398":{"id":2004398,"sourceID":2004320,"targetID":2004334},"2004399":{"id":2004399,"sourceID":2004370,"targetID":2004327},"2004400":{"id":2004400,"sourceID":2004373,"targetID":2004328},"2004410":{"id":2004410,"sourceID":2004383,"targetID":2004327},"2004411":{"id":2004411,"sourceID":2004374,"targetID":2004327},"2004412":{"id":2004412,"sourceID":2004330,"targetID":2004370},"2004413":{"id":2004413,"sourceID":2004372,"targetID":2004327},"2004414":{"id":2004414,"sourceID":2004380,"targetID":2004327},"2004415":{"id":2004415,"sourceID":2004324,"targetID":2004326}},"notes":{"2004336":{"id":2004336,"x":962,"y":-46,"width":116,"height":152,"text":"ADM-673:\n- create another instance for dim_date to get week_ending_sunday of invoice_date.","colour":"e6e63c"},"2004338":{"id":2004338,"x":965,"y":280,"width":116,"height":152,"text":"ADM-673:\n- create another instance for dim_date to get week_ending_sunday of invoice_date.","colour":"e6e63c"},"2004339":{"id":2004339,"x":830,"y":121,"width":250,"height":58,"text":"ADM-673:\n- added distinct component to dim_order before it is joined.","colour":"e6e63c"},"2004340":{"id":2004340,"x":85,"y":-73,"width":511,"height":586,"text":"**raw**","colour":"e6e63c"},"2004341":{"id":2004341,"x":615,"y":193,"width":698,"height":65,"text":"**dims**","colour":"e6e63c"},"2004342":{"id":2004342,"x":1069,"y":-104,"width":250,"height":58,"text":"**dupe checker**\n\nselect \"timecard_id\" as dupe_id,'time_card' as type\nfrom $T{Join time_card}\ngroup by \"timecard_id\" having count(*)>1\n\nunion all\n\nselect \"business_expense_id\" as dupe_id, 'bus_exp' as type\nfrom $T{Join business_expense}\ngroup by \"business_expense_id\" having count(*)>1","colour":"e6e63c"},"2004343":{"id":2004343,"x":1791,"y":86,"width":573,"height":459,"text":"--timecard\nselect\n    coalesce(rdss.source_system_sk , -1)          as source_system_sk\n  , rdss.source_system_name                       as source_system\n  , 'job_time_card'::varchar(255)                 as source_table\n  , coalesce(rde.employee_sk , -1)                as employee_sk\n  , coalesce(rdd.date_sk , -1)                    as date_sk\n  , coalesce(rdo.order_sk , -1)                   as order_sk\n  , coalesce(rdl.client_sk , -1)                  as client_sk\n  , coalesce(rdm.market_sk , -1)                  as market_sk\n  , coalesce(rdc.currency_sk , -1)                as currency_sk\n  , case when jo.payroll_transfer = 0 then 4010\n         else 4070\n    end                                           as account\n  , 111::integer                                  as fee_code_id\n  , jtc1.time_card_id                             as timecard_id\n  , null::integer                                 as business_expense_id\n  , jtc3.adp_batch_id                             as timecard_batch_id\n  , jtc1.emp_person_id                            as employee_person_id\n  , jtc1.week_ending_sunday                       as week_ending_sunday\n  , jtc1.order_id                                 as order_id\n  , oi.order_invoice_id          as order_invoice_id\n  , jo.client_id                                  as client_id\n  , jo.market_id                                  as market_id\n  , cu.currency_id                                as currency_id\n  , ex.currency_exchange_rate_id                  as exchange_rate_id\n  , null::numeric(21,4)                           as client_amount_local\n  , null::numeric(21,4)                           as employee_amount_local\n  , coalesce(jtc1.rebate_amount , 0)              as rebate_amount\n  , null::numeric(21,4)                           as tax_amount\n  , coalesce(jtc2.billing_rate , 0)               as timecard_bill_rate_local\n  , coalesce(jtc2.overtime_billing_rate , 0)      as timecard_overtime_bill_rate_local\n  , coalesce(jtc2.other_billing_rate , 0)         as timecard_other_bill_rate_local\n  , coalesce(jtc2.employee_pay_rate , 0)          as timecard_pay_rate_local\n  , coalesce(jtc2.employee_overtime_pay_rate , 0) as timecard_overtime_pay_rate_local\n  , coalesce(jtc2.employee_other_pay_rate , 0)    as timecard_other_pay_rate_local\n  , coalesce(jtc2.total_regular_hours , 0)        as timecard_regular_hours\n  , coalesce(jtc2.total_overtime_hours , 0)       as timecard_overtime_hours\n  , coalesce(jtc2.total_double_time_hours , 0)    as timecard_double_time_hours\n  , coalesce(jtc2.total_other_hours , 0)          as timecard_other_hours\n  , coalesce(jtc2.total_overtime_1_hours , 0)     as timecard_overtime_1_hours\n  , coalesce(jtc2.total_overtime_2_hours , 0)     as timecard_overtime_2_hours\nfrom exploration.raw_cloudwall_job_time_card1 jtc1\nleft join exploration.raw_cloudwall_job_time_card2 jtc2 on jtc2.time_card_id = jtc1.time_card_id\nleft join exploration.raw_cloudwall_job_time_card3 jtc3 on jtc3.time_card_id = jtc1.time_card_id\nleft join exploration.raw_cloudwall_job_order              jo on jo.order_id = jtc1.order_id\nleft join exploration.raw_cloudwall_market                 ma on ma.market_id   = jo.market_id\nleft join exploration.raw_cloudwall_country                co on co.country_id  = ma.country_id\nleft join exploration.raw_cloudwall_currency               cu on cu.currency_id = co.currency_id\nleft join exploration.raw_cloudwall_currency_exchange_rate ex on ex.currency_id = cu.currency_id and jtc1.week_ending_sunday >= ex.start_date and jtc1.week_ending_sunday < ex.end_date\n\ncross join (select source_system_sk,source_system_name from reporting.dim_source_system where source_system_name = 'cloudwall') rdss\nleft join reporting.dim_date rdd on rdd.calendar_date = jtc1.week_ending_sunday::date\nleft join reporting.dim_market rdm on rdm.market_id = jo.market_id\nleft join reporting.dim_order rdo on rdo.current_record_ind = true\n                                 and rdo.source_system_sk   = rdss.source_system_sk\n                                 and rdo.order_id           = jtc1.order_id\n                                 and rdo.order_position_id  = jtc1.order_position_id\nleft join reporting.dim_currency rdc on rdc.current_record_ind = true\n                                    and rdc.source_system_sk   = rdss.source_system_sk\n                                    and rdc.currency_id        = cu.currency_id\n                                    and rdc.exchange_rate_id   = ex.currency_exchange_rate_id\nleft join reporting.dim_employee rde on rde.current_record_ind  = true\n                                    and rde.cloudwall_talent_id = jtc1.emp_person_id\nleft join reporting.dim_client rdl on rdl.current_record_ind = true\n                                  and rdl.source_system_sk   = rdss.source_system_sk\n                                  and rdl.source_client_id   = jo.client_id\n                                  and rdl.market_id          = jo.market_id\n\nwhere jtc1.time_card_id = 200105674\n;\n\n--business_expense\nselect\n    coalesce(rdss.source_system_sk , -1) as source_system_sk\n  , rdss.source_system_name              as source_system\n  , 'business_expense'::varchar(255)     as source_table\n  , coalesce(rde.employee_sk , -1)       as employee_sk\n  , coalesce(rdd.date_sk , -1)           as date_sk\n  , coalesce(rdo.order_sk , -1)          as order_sk\n  , coalesce(rdl.client_sk , -1)         as client_sk\n  , coalesce(rdm.market_sk , -1)         as market_sk\n  , coalesce(rdc.currency_sk , -1)       as currency_sk\n  , case when jo.payroll_transfer = 1 then 4070\n         when be.fee_code_id =  1 then 4010 --  temp order\n         when be.fee_code_id =  2 then 4050 --  perm placement\n         when be.fee_code_id =  3 then 4040 --  conversion\n         when be.fee_code_id =  5 then 4060 --  billable expense: same amt\n         when be.fee_code_id =  7 then 4110 --  guarantee\n         when be.fee_code_id =  9 then 4030 --  project\n         when be.fee_code_id = 11 then 4060 --  billable expense: different amt\n         when be.fee_code_id = 12 then 4020 --  utilization bonus\n         when be.fee_code_id = 14 then 4010\n         when be.fee_code_id = 15 then 4010\n         when be.fee_code_id = 28 then 4030 -- per ashton 2023-04-13\n         else 4190\n    end                                  as account\n  , be.fee_code_id                       as fee_code_id\n  , null::integer                        as timecard_id\n  , be.business_expense_id               as business_expense_id\n  , be.adp_batch_id                      as timecard_batch_id\n  , be.person_id                         as employee_person_id\n  , be.week_ending_sunday                as week_ending_sunday\n  , op.order_id                          as order_id\n  , oi.order_invoice_id          as order_invoice_id\n  , jo.client_id                         as client_id\n  , jo.market_id                         as market_id\n  , cu.currency_id                       as currency_id\n  , ex.currency_exchange_rate_id         as exchange_rate_id\n  , coalesce(be.client_amount , 0)       as client_amount_local\n  , coalesce(be.employee_amount , 0)     as employee_amount_local\n  , coalesce(be.rebate_amount , '0')::numeric(19,4)     as rebate_amount --source col varchar(1024)\n  , coalesce(oi.tax_amount , 0)          as tax_amount\n  , null::numeric(19,4)                  as timecard_bill_rate_local\n  , null::numeric(19,4)                  as timecard_overtime_bill_rate_local\n  , null::numeric(19,4)                  as timecard_other_bill_rate_local\n  , null::numeric(19,4)                  as timecard_pay_rate_local\n  , null::numeric(19,4)                  as timecard_overtime_pay_rate_local\n  , null::numeric(19,4)                  as timecard_other_pay_rate_local\n  , null::numeric(19,4)                  as timecard_regular_hours\n  , null::numeric(19,4)                  as timecard_overtime_hours\n  , null::numeric(19,4)                  as timecard_double_time_hours\n  , null::numeric(19,4)                  as timecard_other_hours\n  , null::numeric(19,4)                  as timecard_overtime_1_hours\n  , null::numeric(19,4)                  as timecard_overtime_2_hours\n  , bha.hours                                 as hour_adjustment\nfrom exploration.raw_cloudwall_business_expense be\nleft join exploration.raw_cloudwall_order_invoice          oi on oi.order_invoice_id  = be.order_invoice_id\nleft join exploration.raw_cloudwall_order_position         op on op.order_position_id = be.order_position_id\nleft join exploration.raw_cloudwall_job_order              jo on jo.order_id          = op.order_id\nleft join exploration.raw_cloudwall_market                 ma on ma.market_id         = jo.market_id\nleft join exploration.raw_cloudwall_country                co on co.country_id        = ma.country_id\nleft join exploration.raw_cloudwall_currency               cu on cu.currency_id       = co.currency_id\nleft join exploration.raw_cloudwall_currency_exchange_rate ex on ex.currency_id       = cu.currency_id and be.week_ending_sunday >= ex.start_date and be.week_ending_sunday < ex.end_date\nleft join exploration.raw_cloudwall_benefit_hour_adjustment bha on bha.benefit_hour_adjustment_id = be.benefit_hour_adjustment_id\n\ncross join (select source_system_sk,source_system_name from reporting.dim_source_system where source_system_name = 'cloudwall') rdss\nleft join reporting.dim_date rdd on rdd.calendar_date = be.week_ending_sunday::date\nleft join reporting.dim_market rdm on rdm.market_id = jo.market_id\nleft join reporting.dim_order rdo on  rdo.current_record_ind = true\n                                  and rdo.source_system_sk   = rdss.source_system_sk\n                                  and rdo.order_id           = op.order_id\n                                  and rdo.order_position_id  = be.order_position_id\nleft join reporting.dim_currency rdc on  rdc.current_record_ind = true\n                                     and rdc.source_system_sk   = rdss.source_system_sk\n                                     and rdc.currency_id        = cu.currency_id\n                                     and rdc.exchange_rate_id   = ex.currency_exchange_rate_id\nleft join reporting.dim_employee rde on  rde.current_record_ind  = true\n                                     and rde.cloudwall_talent_id = be.person_id\nleft join reporting.dim_client rdl on rdl.current_record_ind = true\n                                  and rdl.source_system_sk = rdss.source_system_sk\n                                  and rdl.source_client_id = jo.client_id\n                                  and rdl.market_id        = jo.market_id\n\nwhere be.business_expense_id = 200010338\n;","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"stage1_cloudwall_fact_financial_metrics_rewrite","description":null,"type":"TRANSFORMATION","tag":"342b0da0-3951-474e-a88d-01348446c768"}}