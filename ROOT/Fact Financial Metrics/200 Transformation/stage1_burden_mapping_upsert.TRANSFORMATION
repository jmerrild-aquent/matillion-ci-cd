{"job":{"components":{"2004524":{"id":2004524,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":720,"y":160,"width":32,"height":32,"inputConnectorIDs":[2004522],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE stg1_burden_mapping"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_burden_mapping"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_date"},"2":{"slot":2,"type":"STRING","value":"etl_update_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"paygroup"},"2":{"slot":2,"type":"STRING","value":"paygroup"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"recordtype"},"2":{"slot":2,"type":"STRING","value":"recordtype"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"recordcategory"},"2":{"slot":2,"type":"STRING","value":"recordcategory"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"recordcode"},"2":{"slot":2,"type":"STRING","value":"recordcode"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"instance_count"},"2":{"slot":2,"type":"STRING","value":"instance_count"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"unique_employee_count"},"2":{"slot":2,"type":"STRING","value":"unique_employee_count"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"earliest_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"earliest_approval_week_ending_sunday"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"latest_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"latest_approval_week_ending_sunday"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"paygroup"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"recordtype"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"recordcategory"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"recordcode"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004525":{"id":2004525,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":720,"y":256,"width":32,"height":32,"inputConnectorIDs":[2004523],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT stg1_burden_mapping"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_burden_mapping"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_date"},"2":{"slot":2,"type":"STRING","value":"etl_create_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"etl_date"},"2":{"slot":2,"type":"STRING","value":"etl_update_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"paygroup"},"2":{"slot":2,"type":"STRING","value":"paygroup"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"recordtype"},"2":{"slot":2,"type":"STRING","value":"recordtype"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"recordcategory"},"2":{"slot":2,"type":"STRING","value":"recordcategory"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"recordcode"},"2":{"slot":2,"type":"STRING","value":"recordcode"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"instance_count"},"2":{"slot":2,"type":"STRING","value":"instance_count"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"unique_employee_count"},"2":{"slot":2,"type":"STRING","value":"unique_employee_count"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"earliest_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"earliest_approval_week_ending_sunday"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"latest_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"latest_approval_week_ending_sunday"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"6":{"slot":6,"name":"Automatic Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004526":{"id":2004526,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":448,"y":112,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004518],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_burden_mapping"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_burden_mapping"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"paygroup"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"recordtype"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"recordcategory"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"recordcode"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"instance_count"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"unique_employee_count"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"earliest_approval_week_ending_sunday"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"latest_approval_week_ending_sunday"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004527":{"id":2004527,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":592,"y":160,"width":32,"height":32,"inputConnectorIDs":[2004520],"outputConnectorIDs":[2004522],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter for Change"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004528":{"id":2004528,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":299,"y":200,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004519],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_df_comp burdens"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\n       fdfc.paygroup\n      ,fdfc.recordtype\n      ,fdfc.recordcategory\n      ,fdfc.recordcode\n      ,count(*) as instance_count\n      ,count(distinct fdfc.employee_xrefcode) as unique_employee_count\n      ,min(rdd.week_ending_sunday) as earliest_approval_week_ending_sunday\n      ,max(rdd.week_ending_sunday) as latest_approval_week_ending_sunday\n      ,sysdate as etl_date\nfrom restricted_analytics_comp.fact_df_comp fdfc\nleft join reporting.dim_date rdd on rdd.date_sk = fdfc.payperiod_start_date_sk\ngroup by\n         fdfc.paygroup\n        ,fdfc.recordtype\n        ,fdfc.recordcategory\n        ,fdfc.recordcode"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004529":{"id":2004529,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":592,"y":256,"width":32,"height":32,"inputConnectorIDs":[2004521],"outputConnectorIDs":[2004523],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter for New"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004531":{"id":2004531,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":448,"y":208,"width":32,"height":32,"inputConnectorIDs":[2004518,2004519],"outputConnectorIDs":[2004520,2004521],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_burden_mapping"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"paygroup"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"recordtype"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"recordcategory"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"recordcode"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"instance_count"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"unique_employee_count"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"earliest_approval_week_ending_sunday"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"latest_approval_week_ending_sunday"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_instance_count"},"2":{"slot":2,"type":"STRING","value":"instance_count"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_unique_employee_count"},"2":{"slot":2,"type":"STRING","value":"unique_employee_count"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_earliest_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"earliest_approval_week_ending_sunday"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_latest_approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"latest_approval_week_ending_sunday"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_etl_date"},"2":{"slot":2,"type":"STRING","value":"etl_date"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"2004518":{"id":2004518,"sourceID":2004526,"targetID":2004531},"2004519":{"id":2004519,"sourceID":2004528,"targetID":2004531},"2004520":{"id":2004520,"sourceID":2004531,"targetID":2004527},"2004521":{"id":2004521,"sourceID":2004531,"targetID":2004529},"2004522":{"id":2004522,"sourceID":2004527,"targetID":2004524},"2004523":{"id":2004523,"sourceID":2004529,"targetID":2004525}},"notes":{"2004530":{"id":2004530,"x":276,"y":315,"width":450,"height":67,"text":"grab all burdens types and simple metrics from fact_df_comp and write to stg1_burden_mapping which is used as a metadata table referenced when calculating burden buckets in table fact_financial_metrics_gross_profit_aggregate","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"stage1_burden_mapping_upsert","description":"","type":"TRANSFORMATION","tag":"06a34b24-43fb-4cfd-b318-f586c497b77e"}}