{"job":{"components":{"2004512":{"id":2004512,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1408,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2004550],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg2_burden_apportion"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg2_burden_apportion"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"staging"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004513":{"id":2004513,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1184,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2004549],"outputConnectorIDs":[2004546],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop columns"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"srckey"},"2":{"slot":2,"type":"STRING","value":"srckey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"employee_person_id"},"2":{"slot":2,"type":"STRING","value":"employee_person_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"approval_week_ending_sunday"},"2":{"slot":2,"type":"STRING","value":"approval_week_ending_sunday"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_cost_regular"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_regular"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_cost_overtime"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_overtime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_cost_double_time"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_double_time"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_cost_other"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_other"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_reimbursement"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_reimbursement"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"app_dental_er"},"2":{"slot":2,"type":"STRING","value":"app_dental_er"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"app_direct_labor_wage_payroll_actual_cost"},"2":{"slot":2,"type":"STRING","value":"app_direct_labor_wage_payroll_actual_cost"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"app_medical_er"},"2":{"slot":2,"type":"STRING","value":"app_medical_er"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_cost"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_bonus"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_bonus"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_talent_commissions"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_commissions"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"app_cpp_er"},"2":{"slot":2,"type":"STRING","value":"app_cpp_er"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"app_ei_er"},"2":{"slot":2,"type":"STRING","value":"app_ei_er"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"app_employer_health_tax"},"2":{"slot":2,"type":"STRING","value":"app_employer_health_tax"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"app_fica"},"2":{"slot":2,"type":"STRING","value":"app_fica"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"app_futa"},"2":{"slot":2,"type":"STRING","value":"app_futa"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"app_other_benefits"},"2":{"slot":2,"type":"STRING","value":"app_other_benefits"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"app_other_tax"},"2":{"slot":2,"type":"STRING","value":"app_other_tax"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"app_qpip_er"},"2":{"slot":2,"type":"STRING","value":"app_qpip_er"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"app_qpp_er"},"2":{"slot":2,"type":"STRING","value":"app_qpp_er"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"app_retirement_er"},"2":{"slot":2,"type":"STRING","value":"app_retirement_er"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"app_suta"},"2":{"slot":2,"type":"STRING","value":"app_suta"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"app_workmans_compensation"},"2":{"slot":2,"type":"STRING","value":"app_workmans_compensation"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"app_paid_time_off"},"2":{"slot":2,"type":"STRING","value":"app_paid_time_off"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"app_sick_cost"},"2":{"slot":2,"type":"STRING","value":"app_sick_cost"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"app_holiday"},"2":{"slot":2,"type":"STRING","value":"app_holiday"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_bench_cost"},"2":{"slot":2,"type":"STRING","value":"app_burden_bench_cost"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"app_burden_practice_group_bench_cost"},"2":{"slot":2,"type":"STRING","value":"app_burden_practice_group_bench_cost"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004514":{"id":2004514,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1280,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2004546],"outputConnectorIDs":[2004550],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rollup"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"null::int"},"2":{"slot":2,"type":"STRING","value":"app_staff_life_er"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"  coalesce(app_dental_er,0)\n+ coalesce(app_holiday,0)\n+ coalesce(app_medical_er,0)\n+ coalesce(app_other_benefits,0)\n+ coalesce(app_paid_time_off,0)\n+ coalesce(app_retirement_er,0)\n+ coalesce(app_sick_cost,0)\n+ coalesce(app_staff_life_er,0)"},"2":{"slot":2,"type":"STRING","value":"app_global_burden_benefits"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"  coalesce(app_fica,0) \n+ coalesce(app_futa,0) \n+ coalesce(app_other_tax,0)\n+ coalesce(app_suta,0) \n+ coalesce(app_workmans_compensation,0)\n+ coalesce(app_cpp_er,0)\n+ coalesce(app_ei_er,0)\n+ coalesce(app_employer_health_tax,0)\n+ coalesce(app_qpip_er,0)\n+ coalesce(app_qpp_er,0)"},"2":{"slot":2,"type":"STRING","value":"app_global_burden_tax"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004515":{"id":2004515,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1056,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2004548],"outputConnectorIDs":[2004549],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calc burden apportions"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"case when \"is_offset_group_cost\" is null then\n\t\tcase when \"cost_rollup_all_bench\" <> 0 then\n\t\t\t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_bench\"::numeric(21,4)) * \"burden_bench_cost\"\n             when \"cost_rollup_all_bench\" = 0 then\n             \tcase when nvl(\"key_count_all_bench\", 0) != 0 then \"burden_bench_cost\" / \"key_count_all_bench\" else 0 end\n        end\n\t when \"is_offset_group_cost\" = true then\n\t\tcase when \"key_count_cost_nonoffset_bench\" = 0 then\n\t    \t\tcase when nvl(\"key_count_all_bench\", 0) != 0 then \"burden_bench_cost\" / \"key_count_all_bench\" else 0 end\n             when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_bench\" <> 0 then\n             \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_bench\"::numeric(21,4)) * \"burden_bench_cost\"\n             when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_bench\" = 0 then\n             \tcase when nvl(\"key_count_cost_nonoffset_bench\", 0) != 0 then \"burden_bench_cost\" / \"key_count_cost_nonoffset_bench\" else 0 end\n        end\nend"},"2":{"slot":2,"type":"STRING","value":"app_burden_bench_cost"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then \n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"burden_talent_bonus\"\n                 when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_bonus\" / \"key_count_all_tc_sal\" else 0 end\n            end\n         when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_bonus\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"burden_talent_bonus\"\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"burden_talent_bonus\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n            end\n    end\n"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_bonus"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then \n    \tcase when \"cost_rollup_all_tc_sal\" <> 0 then \n        \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"burden_talent_cost\"\n             when \"cost_rollup_all_tc_sal\" = 0 then\n             \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_cost\" / \"key_count_all_tc_sal\" else 0 end\n        end\n\t\t when \"is_offset_group_cost\" = true then \n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_cost\" / \"key_count_all_tc_sal\" else 0 end\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"burden_talent_cost\"\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"burden_talent_cost\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n            end\n\tend\n"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"burden_talent_commissions\"\n                 when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_commissions\" / \"key_count_all_tc_sal\" else 0 end\n            end\n         when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_commissions\" / \"key_count_all_tc_sal\" else 0 end\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"burden_talent_commissions\"\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"burden_talent_commissions\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend\n"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_commissions"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_hours\" is null then\n    \t\tcase when \"hours_rollup_all_tc\" <> 0 then\n            \t\t(\"hours\" / \"hours_rollup_all_tc\") * \"burden_talent_cost_double_time\"\n                 when \"hours_rollup_all_tc\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_double_time\" / \"key_count_all_tc\" else 0 end\n            end\n         when \"is_offset_group_hours\" = true then\n         \tcase when \"key_count_hours_nonoffset_tc\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_double_time\" / \"key_count_all_tc\" else 0 end\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" <> 0 then\n                 \t(\"hours\" / \"hours_rollup_nonoffset_tc\") * \"burden_talent_cost_double_time\"\n                 when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" = 0 then\n                 \tcase when nvl(\"key_count_hours_nonoffset_tc\", 0) != 0 then \"burden_talent_cost_double_time\" / \"key_count_hours_nonoffset_tc\" else 0 end\n            end\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_double_time"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_hours\" is null then\n    \t\tcase when \"hours_rollup_all_tc\" <> 0 then\n            \t\t(\"hours\" / \"hours_rollup_all_tc\") * \"burden_talent_cost_overtime\"\n                 when \"hours_rollup_all_tc\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_overtime\" / \"key_count_all_tc\" else 0 end\n            end\n         when \"is_offset_group_hours\" = true then\n         \tcase when \"key_count_hours_nonoffset_tc\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_overtime\" / \"key_count_all_tc\" else 0 end\n                 when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" <> 0 then\n                 \t(\"hours\" / \"hours_rollup_nonoffset_tc\") * \"burden_talent_cost_overtime\"\n                 when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" = 0 then\n                 \tcase when nvl(\"key_count_hours_nonoffset_tc\", 0) != 0 then \"burden_talent_cost_overtime\" / \"key_count_hours_nonoffset_tc\" else 0 end\n            end\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_overtime"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"case when \"is_offset_group_hours\" is null then\n\t\tcase when \"hours_rollup_all_tc\" <> 0 then\n        \t\t(\"hours\" / \"hours_rollup_all_tc\") * \"burden_talent_cost_regular\"\n\t\t\t when \"hours_rollup_all_tc\" = 0 then\n             \tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_regular\" / \"key_count_all_tc\" else 0 end\n\t\tend\n\t when \"is_offset_group_hours\" = true then\n     \tcase when \"key_count_hours_nonoffset_tc\" = 0 then\n\t\t\t\tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_regular\" / \"key_count_all_tc\" else 0 end\n\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" <> 0 then\n             \t(\"hours\" / \"hours_rollup_nonoffset_tc\") * \"burden_talent_cost_regular\"\n\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" = 0 then\n             \tcase when nvl(\"key_count_hours_nonoffset_tc\", 0) != 0 then \"burden_talent_cost_regular\" / \"key_count_hours_nonoffset_tc\" else 0 end\n\t\tend\nend"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_regular"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then \n    \tcase when \"cost_rollup_all_tc_sal\" <> 0 then \n        \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"burden_talent_reimbursement\"\n             when \"cost_rollup_all_tc_sal\" = 0 then\n             \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_reimbursement\" / \"key_count_all_tc_sal\" else 0 end\n        end\n\t\t when \"is_offset_group_cost\" = true then \n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"burden_talent_reimbursement\" / \"key_count_all_tc_sal\" else 0 end\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"burden_talent_reimbursement\"\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"burden_talent_reimbursement\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n            end\n\tend\n"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_reimbursement"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"cpp_er\"\n                 when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"cpp_er\" / \"key_count_all_tc_sal\" else 0 end\n            end\n         when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"cpp_er\" / \"key_count_all_tc_sal\" else 0 end\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"cpp_er\"\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"cpp_er\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_cpp_er"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_hours\" is null then\n    \t\tcase when \"hours_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"hours\" / \"hours_rollup_all_tc_sal\") * \"dental_er\"\n\t\t\t\t when \"hours_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"dental_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n         when \"is_offset_group_hours\" = true then\n         \tcase when \"key_count_hours_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"dental_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"hours\" / \"hours_rollup_nonoffset_tc_sal\") * \"dental_er\"\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_hours_nonoffset_tc_sal\", 0) != 0 then \"dental_er\" / \"key_count_hours_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_dental_er"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_hours\" is null then\n    \t\tcase when \"hours_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"hours\" / \"hours_rollup_all_tc_sal\") * \"direct_labor_wage_payroll_actual_cost\"\n\t\t \t\t when \"hours_rollup_all_tc_sal\" = 0 then\n         \t\t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"direct_labor_wage_payroll_actual_cost\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_hours\" = true then\n         \tcase when \"key_count_hours_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"direct_labor_wage_payroll_actual_cost\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"hours\" / \"hours_rollup_nonoffset_tc_sal\") * \"direct_labor_wage_payroll_actual_cost\"\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_hours_nonoffset_tc_sal\", 0) != 0 then \"direct_labor_wage_payroll_actual_cost\" / \"key_count_hours_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_direct_labor_wage_payroll_actual_cost"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"ei_er\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"ei_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n         when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"ei_er\" / \"key_count_all_tc_sal\" else 0 end\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                    (\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"ei_er\"\n                 when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                    case when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"ei_er\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n            end\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_ei_er"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_holiday\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_holiday\"::numeric(21,4)) * \"holiday\"\n\t\t\t\t when \"cost_rollup_all_holiday\" = 0 then\n                 \tcase when nvl(\"key_count_all_holiday\", 0) != 0 then \"holiday\" / \"key_count_all_holiday\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_holiday\" = 0 then\n            \t\tcase when nvl(\"key_count_all_holiday\", 0) != 0 then \"holiday\" / \"key_count_all_holiday\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_holiday\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_holiday\"::numeric(21,4)) * \"holiday\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_holiday\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_holiday\", 0) != 0 then \"holiday\" / \"key_count_cost_nonoffset_holiday\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_holiday"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_hours\" is null then\n    \t\tcase when \"hours_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"hours\" / \"hours_rollup_all_tc_sal\") * \"medical_er\"\n\t\t\t\t when \"hours_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"medical_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_hours\" = true then\n         \tcase when \"key_count_hours_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"medical_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"hours\" / \"hours_rollup_nonoffset_tc_sal\") * \"medical_er\"\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_hours_nonoffset_tc_sal\", 0) != 0 then \"medical_er\" / \"key_count_hours_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_medical_er"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"other_benefits\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"other_benefits\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"other_benefits\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"other_benefits\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"other_benefits\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_other_benefits"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"other_tax\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"other_tax\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"other_tax\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"other_tax\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"other_tax\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_other_tax"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_pto\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_pto\"::numeric(21,4)) * \"paid_time_off\"\n\t\t\t\t when \"cost_rollup_all_pto\" = 0 then\n                 \tcase when nvl(\"key_count_all_pto\", 0) != 0 then \"paid_time_off\" / \"key_count_all_pto\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_pto\" = 0 then\n            \t\tcase when nvl(\"key_count_all_pto\", 0) != 0 then \"paid_time_off\" / \"key_count_all_pto\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_pto\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_pto\"::numeric(21,4)) * \"paid_time_off\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_pto\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_pto\", 0) != 0 then \"paid_time_off\" / \"key_count_cost_nonoffset_pto\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_paid_time_off"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"qpip_er\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"qpip_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"qpip_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"qpip_er\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"qpip_er\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_qpip_er"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"qpp_er\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"qpp_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"qpp_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"qpp_er\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"qpp_er\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_qpp_er"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"retirement_er\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"retirement_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"retirement_er\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"retirement_er\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"retirement_er\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_retirement_er"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_sick\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_sick\"::numeric(21,4)) * \"sick_cost\"\n\t\t\t\t when \"cost_rollup_all_sick\" = 0 then\n                 \tcase when nvl(\"key_count_all_sick\", 0) != 0 then \"sick_cost\" / \"key_count_all_sick\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_sick\" = 0 then\n            \t\tcase when nvl(\"key_count_all_sick\", 0) != 0 then \"sick_cost\" / \"key_count_all_sick\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_sick\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_sick\"::numeric(21,4)) * \"sick_cost\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_sick\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_sick\", 0) != 0 then \"sick_cost\" / \"key_count_cost_nonoffset_sick\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_sick_cost"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then \n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"suta\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"suta\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"suta\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"suta\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \t\"suta\" / \"key_count_cost_nonoffset_tc_sal\"\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_suta"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"workmans_compensation\"\n\t\t\t\t when cost_rollup_all_tc_sal = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"workmans_compensation\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"workmans_compensation\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"workmans_compensation\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"workmans_compensation\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_workmans_compensation"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"fica\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"fica\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"fica\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"fica\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"fica\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_fica"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"futa\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"futa\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"futa\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"futa\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"futa\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_futa"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_cost\" is null then\n    \t\tcase when \"cost_rollup_all_tc_sal\" <> 0 then\n            \t\t(\"cost\"::numeric(21,4) / \"cost_rollup_all_tc_sal\"::numeric(21,4)) * \"employer_health_tax\"\n\t\t\t\t when \"cost_rollup_all_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"employer_health_tax\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_cost\" = true then\n         \tcase when \"key_count_cost_nonoffset_tc_sal\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc_sal\", 0) != 0 then \"employer_health_tax\" / \"key_count_all_tc_sal\" else 0 end\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" <> 0 then\n                 \t(\"cost\"::numeric(21,4) / \"cost_rollup_nonoffset_tc_sal\"::numeric(21,4)) * \"employer_health_tax\"\n\t\t\t\t when \"is_offset_cost\" is null and \"cost_rollup_nonoffset_tc_sal\" = 0 then\n                 \tcase when nvl(\"key_count_cost_nonoffset_tc_sal\", 0) != 0 then \"employer_health_tax\" / \"key_count_cost_nonoffset_tc_sal\" else 0 end\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_employer_health_tax"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"\tcase when \"is_offset_group_hours\" is null then\n    \t\tcase when \"hours_rollup_all_tc\" <> 0 then\n            \t\t(\"hours\" / \"hours_rollup_all_tc\") * \"burden_talent_cost_other\"\n\t\t\t\t when \"hours_rollup_all_tc\" = 0 then\n                 \tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_other\" / \"key_count_all_tc\" else 0 end\n\t\t\tend\n\t\t when \"is_offset_group_hours\" = true then\n         \tcase when \"key_count_hours_nonoffset_tc\" = 0 then\n            \t\tcase when nvl(\"key_count_all_tc\", 0) != 0 then \"burden_talent_cost_other\" / \"key_count_all_tc\" else 0 end\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" <> 0 then\n                 \t(\"hours\" / \"hours_rollup_nonoffset_tc\") * \"burden_talent_cost_other\"\n\t\t\t\t when \"is_offset_hours\" is null and \"hours_rollup_nonoffset_tc\" = 0 then\n                 \t\"burden_talent_cost_other\" / \"key_count_hours_nonoffset_tc\"\n\t\t\tend\n\tend"},"2":{"slot":2,"type":"STRING","value":"app_burden_talent_cost_other"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"0::numeric(21,4)"},"2":{"slot":2,"type":"STRING","value":"app_burden_practice_group_bench_cost"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2004517":{"id":2004517,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":896,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2004548],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg1_burden_apportion"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/*\n  Apportion logic is generally the same flow for all burdens\n  \n  - Join dayforce & cloudwall financials on (employee_person_id & approval_week_ending_sunday & relevant financials for the burden)\n  \n  - build out supporting rollups/aggregations over emp/wes to apportion evenly or proportionately across individual financials\n  \t  - many burdens have matching logic, like they only apply to certain types of financials or are apportioned by hours or costs\n      \t  - so rollups are named to identify these by referencing \"hours\"/\"cost\" or \"tc\"/\"sal\".\n          \t  - \"tc\"/\"sal\" means the burden only applies to financials that are fee_code_id 10 & 111 (salary business expense & timecard)\n              - \"hours\"/\"cost\" describes how the burden is apportioned across the financials its attached to, by hours or cost on the financials\n  \t\t\t  \t  - https://docs.google.com/spreadsheets/d/1Pe8Fp1B08F1DF1vlECGw7ORUYtMH-FOoQ5XkDN3YWCQ\n  \n  - split emp/wes into groups \n  \t  - contains an offsetting financial (negative hours or cost)\n      - doesnt contain an offsetting financial\n  \t\n      - nonoffset group\n          - if the rollup !=0 then spread dayforce amount proportionately across all attached financials in the emp/wes group\n              - this covers a majority of the data\n          - if the rollup  =0 then spread dayforce amount evenly          across all attached financials in the emp/wes group\n          \t  - example: no hours or cost are in cloudwall but dayforce contains a burden. odd but its out there\n          \n      - offset group\n          - if all financials in the group are offsetting then spread the dayforce amount evenly across all financials\n          - if nonoffsetting rollup !=0 then spread dayforce amount proportionately across all attached               financials in the emp/wes group\n\t\t  - if nonoffsetting rollup  =0 then spread dayforce amount evenly          across all attached nonoffsetting financials in the emp/wes group\n*/\nwith df as (select * from staging.stg1_burden_fact_financial_metrics)\n   , ffm as (select *,case when fee_code_id = 10 then true end as is_bench\n             from staging.stg1_burden_apportion)\nselect  ffm.sources\n\t,\tffm.financial_types\n\t,\tffm.srckey\n\t,\tffm.employee_person_id\n\t,\tffm.approval_week_ending_sunday\n    \n\t--offset indicator\n\t,\tcase when (nvl(hours, 0) <0) and is_backdated=true then true end as is_offset_hours\n    ,\tcase when (nvl(cost, 0) <0) and is_backdated=true then true end as is_offset_cost\n    ,\t(max(case when is_offset_hours=true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday))::boolean as is_offset_group_hours\n    ,\t(max(case when is_offset_cost =true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday))::boolean as is_offset_group_cost\n    \n    --special handling of rh salaried records to set total hours to 40 if < 40\n\t,\tnvl(sum(case when fee_code_id =\t0 and ffm.is_staff_salaried = true then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\tas\torig_hours_rollup_rh_sal\n\t,\tnvl(sum(case when fee_code_id = 0 and ffm.is_staff_salaried = true and is_offset_hours = true then hours end) over (partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\tas\thours_rollup_offset_rh_sal\t\n\t,\tnvl(sum(case when fee_code_id =\t0 and ffm.is_staff_salaried is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\tas\thours_rollup_rh_tc\n\t,\tnvl(sum(case when fee_code_id =\t0 and ffm.is_staff_salaried is null and is_offset_hours is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\tas\thours_rollup_nonoffset_rh_tc\n    ,\tnvl(sum(case when fee_code_id = 10 and ffm.is_staff_salaried = true then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) + orig_hours_rollup_rh_sal\tas orig_hours_rollup_all_sal\n    ,\tcase when ffm.fee_code_id = 0 and ffm.is_staff_salaried = true and orig_hours_rollup_rh_sal > 0.00 and orig_hours_rollup_rh_sal < 40.00 then 40.00\n    \t\t when ffm.fee_code_id = 10 and ffm.is_staff_salaried = true and orig_hours_rollup_rh_sal > 0.00 and orig_hours_rollup_rh_sal < 40.00 then 40.00 \n        else \n        \torig_hours_rollup_all_sal \n        end\tas\thours_rollup_all_sal\n    ,\thours_rollup_all_sal - nvl(hours_rollup_offset_rh_sal, 0)\tas\thours_rollup_nonoffset_rh_sal\n    \n    ,\tffm.hours\n\t,\tffm.cost\n\t,\tffm.fee_code_id\n\t,\tffm.is_bench\n\t,\tffm.is_backdated\n\t,\tffm.timeslip_id\n\t,\tffm.working_week_ending_sunday\n\t,\tffm.project_id\n    ,\tffm.client_id\n    ,\tffm.is_staff_salaried\n\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_bench_cost, 0) when ffm.is_bench = true then nvl(df.burden_bench_cost, 0) else 0 end \tas\tburden_bench_cost --note: for rh ignore is_bench identifier.\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_bonus, 0) when ffm.fee_code_id in (10,111) then nvl(df.burden_talent_bonus, 0) else 0 end \tas\tburden_talent_bonus\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_commissions, 0)\twhen ffm.fee_code_id in (10,111) then nvl(df.burden_talent_commissions, 0) else 0 end as\tburden_talent_commissions\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_cost, 0) when ffm.fee_code_id in (10,111) then nvl(df.burden_talent_cost, 0) else 0 end\tas\tburden_talent_cost\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_cost_double_time, 0) when ffm.fee_code_id = 111 then nvl(df.burden_talent_cost_double_time, 0) else 0 end\tas\tburden_talent_cost_double_time\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_cost_other, 0) when ffm.fee_code_id = 111 then nvl(df.burden_talent_cost_other, 0) else 0 end\tas\tburden_talent_cost_other\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_cost_overtime, 0) when ffm.fee_code_id = 111 then nvl(df.burden_talent_cost_overtime, 0) else 0 end\tas\tburden_talent_cost_overtime\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_cost_regular, 0) when ffm.fee_code_id = 111 then nvl(df.burden_talent_cost_regular, 0) else 0 end \tas\tburden_talent_cost_regular\n    ,\tcase when ffm.fee_code_id = 0 then nvl(df.burden_talent_reimbursement, 0) when ffm.fee_code_id in (10,111) then nvl(df.burden_talent_reimbursement, 0) else 0 end\tas\tburden_talent_reimbursement\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.cpp_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.cpp_er, 0) else 0 end\tas\tcpp_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.dental_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.dental_er, 0) else 0 end \tas\tdental_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.direct_labor_wage_payroll_actual_cost, 0) when ffm.fee_code_id in (10,111) then nvl(df.direct_labor_wage_payroll_actual_cost, 0) else 0 end\tas\tdirect_labor_wage_payroll_actual_cost\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.ei_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.ei_er, 0) else 0 end\tas\tei_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.employer_health_tax, 0) when ffm.fee_code_id in (10,111) then nvl(df.employer_health_tax, 0) else 0 end\tas\temployer_health_tax\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.fica, 0) when ffm.fee_code_id in (10,111) then nvl(df.fica, 0) else 0 end\tas\tfica\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.futa, 0) when ffm.fee_code_id in (10,111) then nvl(df.futa, 0) else 0 end\tas\tfuta\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.holiday, 0) when ffm.fee_code_id = 13 then nvl(df.holiday, 0) else 0 end\tas\tholiday\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.medical_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.medical_er, 0) else 0 end\tas\tmedical_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.other_benefits, 0) when ffm.fee_code_id in (10,111) then nvl(df.other_benefits, 0) else 0 end\tas\tother_benefits\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.other_tax, 0) when ffm.fee_code_id in (10,111) then nvl(df.other_tax, 0) else 0 end \tas\tother_tax\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.paid_time_off, 0) when ffm.fee_code_id in (17,30,31) then nvl(df.paid_time_off, 0) else 0 end\tas\tpaid_time_off\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.qpip_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.qpip_er, 0) else 0 end\tas\tqpip_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.qpp_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.qpp_er, 0) else 0 end\tas\tqpp_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.retirement_er, 0) when ffm.fee_code_id in (10,111) then nvl(df.retirement_er, 0) else 0 end\tas\tretirement_er\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.sick_cost, 0) when ffm.fee_code_id in (16,27) then nvl(df.sick_cost, 0) else 0 end\tas\tsick_cost\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.suta, 0) when ffm.fee_code_id in (10,111) then nvl(df.suta, 0) else 0 end\tas\tsuta\n\t,\tcase when ffm.fee_code_id = 0 then nvl(df.workmans_compensation, 0) when ffm.fee_code_id in (10,111) then nvl(df.workmans_compensation, 0) else 0 end\tas\tworkmans_compensation\n\n--key counts\n\t,\tcount(1) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday)\tas\tkey_count_all\n    ,\tcount(case when fee_code_id in (0,111)                             then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_all_tc\n    ,\tcount(case when fee_code_id in (0,111) and is_offset_hours is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_hours_offset_tc\n    ,\tcount(case when fee_code_id in (0,111) and is_offset_hours is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_hours_nonoffset_tc\n    \n    ,\tcount(case when fee_code_id in (0,10,111)                             then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_all_tc_sal\n    ,\tcount(case when fee_code_id in (0,10,111) and is_offset_cost  is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_offset_tc_sal\n    ,\tcount(case when fee_code_id in (0,10,111) and is_offset_cost  is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_nonoffset_tc_sal\n    ,\tcount(case when fee_code_id in (0,10,111) and is_offset_hours is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_hours_offset_tc_sal\n    ,\tcount(case when fee_code_id in (0,10,111) and is_offset_hours is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_hours_nonoffset_tc_sal\n    \n    ,\tcount(case when fee_code_id in (0,17,30,31)                            then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_all_pto\n    ,\tcount(case when fee_code_id in (0,17,30,31) and is_offset_cost is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_offset_pto\n    ,\tcount(case when fee_code_id in (0,17,30,31) and is_offset_cost is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_nonoffset_pto\n    \n    ,\tcount(case when fee_code_id in (0,16,27)                            then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_all_sick\n    ,\tcount(case when fee_code_id in (0,16,27) and is_offset_cost is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_offset_sick\n    ,\tcount(case when fee_code_id in (0,16,27) and is_offset_cost is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_nonoffset_sick\n    \n    ,\tcount(case when fee_code_id in (0,13)                            then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_all_holiday\n    ,\tcount(case when fee_code_id in (0,13) and is_offset_cost is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_offset_holiday\n    ,\tcount(case when fee_code_id in (0,13) and is_offset_cost is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_nonoffset_holiday\n    \n    ,\tcount(case when fee_code_id !=0 and is_bench = true                            then 1\n                   when fee_code_id = 0 \t\t\t\t\t                           then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_all_bench\n    ,\tcount(case when is_bench = true and is_offset_cost is true then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_offset_bench\n    ,\tcount(case when is_bench = true and is_offset_cost is null then 1 end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday) as key_count_cost_nonoffset_bench\n--hour rollups\n    ,\tnvl(sum(case when fee_code_id in (111)                             then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as hours_rollup_cw_tc\n    ,\tcase when (hours_rollup_rh_tc + hours_rollup_cw_tc) != 0 then nvl(sum(case when fee_code_id in (0, 111) then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\n    \telse\n        \tnvl(sum(case when fee_code_id = 111 then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) + hours_rollup_rh_tc + hours_rollup_all_sal\n        end\tas\thours_rollup_all_tc\n    ,\tnvl(sum(case when fee_code_id in (111) and is_offset_hours is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as hours_rollup_nonoffset_cw_tc\n    ,\tcase when (hours_rollup_nonoffset_rh_tc + hours_rollup_nonoffset_cw_tc) != 0 then nvl(sum(case when fee_code_id in (0,111) and is_offset_hours is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\n    \telse\n       \t\tnvl(sum(case when fee_code_id in (111) and is_offset_hours is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) + hours_rollup_nonoffset_rh_tc + hours_rollup_nonoffset_rh_sal\n        end\tas\thours_rollup_nonoffset_tc\n    \n\t,\tnvl(sum(case when fee_code_id = 111                             then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) + hours_rollup_rh_tc + hours_rollup_all_sal\tas hours_rollup_all_tc_sal\n\t,\tnvl(sum(case when fee_code_id in (10,111) and is_offset_hours is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) + hours_rollup_nonoffset_rh_tc + hours_rollup_nonoffset_rh_sal as hours_rollup_nonoffset_tc_sal\n\n    --,\tnvl(sum(case when fee_code_id in (0,10,111)                             then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\tas hours_rollup_all_tc_sal\n    --,\tnvl(sum(case when fee_code_id in (0,10,111) and is_offset_hours is null then hours end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0)\tas hours_rollup_nonoffset_tc_sal\n    \n--cost rollups    \n    ,\tnvl(sum(case when fee_code_id in (0,10,111)                            then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_all_tc_sal\n    ,\tnvl(sum(case when fee_code_id in (0,10,111) and is_offset_cost is null then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_nonoffset_tc_sal\n    \n    ,\tnvl(sum(case when fee_code_id in (0,17,30,31)                            then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_all_pto\n    ,\tnvl(sum(case when fee_code_id in (0,17,30,31) and is_offset_cost is null then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_nonoffset_pto\n    \n    ,\tnvl(sum(case when fee_code_id in (0,16,27)                            then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_all_sick\n    ,\tnvl(sum(case when fee_code_id in (0,16,27) and is_offset_cost is null then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_nonoffset_sick\n    \n    ,\tnvl(sum(case when fee_code_id in (0,13)                            then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_all_holiday\n    ,\tnvl(sum(case when fee_code_id in (0,13) and is_offset_cost is null then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_nonoffset_holiday\n    \n    ,\tnvl(sum(case when fee_code_id != 0 and is_bench = true                            then cost\n                     when fee_code_id = 0 then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_all_bench\n    ,\tnvl(sum(case when fee_code_id != 0 and is_bench = true and is_offset_cost is null then cost\n                     when fee_code_id = 0 and is_offset_cost is null then cost end) over(partition by ffm.employee_person_id,ffm.approval_week_ending_sunday), 0) as cost_rollup_nonoffset_bench\nfrom    ffm\n        left join df on ffm.employee_person_id = df.employee_person_id\n    \t\t\t\tand ffm.approval_week_ending_sunday = df.approval_week_ending_sunday"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"2004546":{"id":2004546,"sourceID":2004513,"targetID":2004514},"2004548":{"id":2004548,"sourceID":2004517,"targetID":2004515},"2004549":{"id":2004549,"sourceID":2004515,"targetID":2004513},"2004550":{"id":2004550,"sourceID":2004514,"targetID":2004512}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"stage2_burden_apportion_rewrite","description":"","type":"TRANSFORMATION","tag":"0dda3334-b3bf-4a40-a504-cd992b9737e4"}}